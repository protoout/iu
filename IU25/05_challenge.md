# 05. 応用課題（自分の題材でRAG×LINE Bot）

このパートでは、これまで作った仕組みをベースに **自分の題材** に置き換えて、  
**RAGを入れたLINE Bot** を制作します。時間があれば **リッチメニュー** まで整えて、見た目を仕上げましょう。

---

## 1. このパートで作るもの「自分の題材のRAG活用LINE Bot」

### 1-1. 作成するものの概要

- 自分の身の回りの困りごとを1つ決める
- それを解決するための「Q&Aチャットボット」を作る
- Difyのナレッジ（RAG）を使って、根拠のある回答ができるようにする
- LINE Botとして使える形にして、時間があればリッチメニューも追加する

---

## 2. ワーク：困りごと → 制作案を決める

### 2-1. 身の回りの困りごとを1つ選ぶ

まずは「誰が / いつ / 何に困っているか」を短く書き出します。

例
- 大学：施設や窓口の場所・時間が分からない
- 授業：課題の提出方法や締切が毎回分からなくなる
- サークル：備品の場所、ルール、予約方法が共有されていない
- アルバイト：緊急時の対応やマニュアルが探しづらい
- イベント：集合場所、持ち物、当日の流れを何度も聞かれる

### 2-2. 解決方法（制作案）を決める

「困りごと」を選んだら、次に **どんなBotを作るか（制作案）** を決めます。  
ここで決めるのは、ざっくり次の3点です。

- **誰のためのBotか**（自分 / 同級生 / サークル / バイト先 など）
- **何を答えられるBotにするか**（範囲を決める）
- **どんな情報（ナレッジ）を用意するか**（RAGの材料）

#### 制作案の例
- 対象ユーザー：大学の同級生
- 困りごと：施設の場所・開館時間・窓口が分からない
- Botの役割：学内施設案内のQ&A（場所/時間/問い合わせ先）
- 参照させる情報：大学サイトの施設ページ、窓口案内、学内マップ説明
- 代表質問：
  - Q1：図書館の開館時間は？
  - Q2：学生課はどこ？何時まで？
  - Q3：体育館の利用ルールは？

---
### 2-3. 制作ワーク：内容をワークシートにまとめる

制作物の内容を [制作ワーク](https://docs.google.com/spreadsheets/d/1oLxuu5APnb8F0h7VE1wiXt8Ad9AW5i1qbG5wjdJ7qPc/edit?gid=1943902863#gid=1943902863) にまとめておきましょう。

書くこと（目安）
- 困りごと（誰が / いつ / 何に困る？）
- 制作案（Botでどう解決する？）
- 読み込ませたナレッジ（何を入れた？自分で作った？）

---

## 3. ハンズオン：自分の題材でRAGを入れる

### 3-1. ナレッジ（読み込ませる資料）を用意する

方法は主に3つ。
1. 大学や施設のWebページの文章をコピペして1つの `.md` / `.txt` にまとめる
2. 自分のメモ（ルール、Q&A、手順）を `.md` に書く
3. 配布資料やマニュアルをテキスト化してまとめる
  - **大学・施設のWebページを集める**
    - 施設案内 / よくある質問 / 窓口案内 / 利用ルール など
  - **PDFや配布資料から文章を取り出す**
    - 授業ガイド / 申請手順 / マニュアル など
ポイント
- 最初は「1ファイルでOK」。量よりも「実際に答えられる」状態を優先します
- 見出し（例：`##`）で章分けすると検索しやすくなります

#### 例：ナレッジの構造（サンプル）
```md
## 図書館
利用時間：〇〇
場所：〇〇
ルール：〇〇

## 学生課
利用時間：〇〇
場所：〇〇
よくある質問：〇〇

## よくある質問
Q：〇〇？
A：〇〇
```

### 3-2. Difyのナレッジに登録する

- ナレッジベースを作成
- 3-1で用意したファイルをアップロード
- チャンク設定 / 検索設定を行い、保存して処理

### 3-3. チャットフローに「知識検索」をつなぐ

- 開始ノードとLLMノードの間に「知識検索」を入れる
- LLMのコンテキストに「知識検索の結果」を渡す
- プロンプトを「自分の題材」に合わせて調整する  

元の資料がバラバラだったり、文章が長くて読みにくい場合は、AIに整理させると早いです。

- 例：Webページの文章を貼って頼む
  - 施設案内をQ&Aに整理して  
  - 重要ポイントを箇条書きにして  
  - 「場所 / 時間 / ルール / 問い合わせ先」に分解して  
  - 重複を消して短くまとめて

> 注意：AIが勝手に“作り話”を混ぜないように、  
> 「元の文章に書いてあることだけでまとめて」と指示すると安全です。

---

## 4. LINE Botで動かしてみる

- LINEから実際に質問して、回答が返ってくるか確認します
- テスト質問（2-2で作った3つ）を投げてみて、答え方を調整します

改善のコツ
- うまく答えない場合は、まず「ナレッジの内容が質問に足りているか」を確認
- 次に「プロンプトで“コンテキストに基づいて答える”を強める」

---

## 5. 追加チャレンジ：リッチメニューで見た目を整える（時間があれば）

リッチメニューという機能を使うと、LINE Botの見栄えが格段に上がります。  
特にプログラムが必要とかでもなく設定からいけるので、やれる人はチャレンジしてアプリケーションとしての使い勝手を上げましょう。

- LINE公式アカウント（LINE Official Account Manager）リッチメニューを作成するマニュアル｜LINEヤフー for Business  
  https://www.lycbiz.com/jp/manual/OfficialAccountManager/rich-menus/

プログラム的に制御もできます
- リッチメニューを使う（LINE Developers）  
  https://developers.line.biz/ja/docs/messaging-api/using-rich-menus/
<img src="https://i.gyazo.com/669a86b1940aa84ba5da6098e37057b0.png" width="450px" alt="image from gyazo"/>
---

このページの内容は以上です。  
[◀ 目次ページ](./readme.md)

- [次の資料へ](./06_conclusion.md)
- [前の資料へ](./04_rag.md)
