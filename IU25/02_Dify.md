## 目次
- [0. オープニング](#0-オープニング)
- [1. Difyで簡単なチャットアプリを作る](#1-difyで簡単なチャットアプリを作る)
- [2. モデルプロバイダーをGeminiへ](#2-モデルプロバイダーをgeminiへ)
- [3. RAGアプリを作成](#3-ragアプリを作成)
- [4. 追加機能も入れてみる（時間次第）](#4-追加機能も入れてみる時間次第)
- [5. LINEのプラグインでLINE Bot化](#5-lineのプラグインでline-bot化)
- [6. GPT5かgpt-ossも使ってみる（おまけ）](#6-gpt5かgpt-ossも使ってみるおまけ)
- [7. 自由時間](#7-自由時間)
- [8. まとめ](#8-まとめ)

---

## 0. オープニング

### 0-1. 講師紹介
- **川口眞里奈**
  - LINE API Expert
  - プロトタイピングスクール「プロトアウトスタジオ」
- YouTube最近動画あげてます。チャンネル登録お願いします。 

### 0-2. 今日作るものと流れ
- **盛岡の情報に詳しいAI**を作ってみる  
- **Difyのバグが見つかってLINE連携はちょっと怪しいかも**（後述）

**流れ**
- STEP1: RAGを用いて盛岡の情報に強いAIチャットアプリ
- STEP2: これをLINEで動かす  
  - LINE公式アカウントの事前準備できてない人いると予想してSTEP2にしています  
  - 準備できてない人は時間内にできない疑惑あるので後でためしてね  
  - あとDifyのバグが...

### 0-3. 使うツールや用語

#### Dify
- ノーコードでAIアプリ作れるプラットフォーム
- ノードと呼ばれるブロックをつなげてチャットアプリなどを作れる
- 読み方が公式に「ディフィー」になってしまってみんな戸惑っていた

#### RAG
- AIに検索機能を持たせて回答精度をあげるテクニック
- インデクサー、リトリーバー、リランカーなど
- Difyだと**ナレッジ機能**で利用可能

#### LINE Bot
- 普段みんなが使うLINEに、自分で作ったプログラムを接続して制御できます

### 0-4. 準備確認
以下の3つのアカウント準備が出来ているところからスタートします。
- Googleアカウント
- Difyアカウント
- LINE公式アカウント

**LINE公式アカウントの準備範囲**
- チャンネルシークレット
- アクセストークン  
  の取得までが準備です。

**参考（イベントページ記載）**
- 以下URLの記事の「4-2. Messaging APIの有効化」まで  
  - https://zenn.dev/protoout/articles/16-line-bot-setup
- 「やばい」って方は、この後冒頭で話をしていくので、その話を聴きながら作業を進めましょう。

### 0-5. ハンズオンの受け方注意

**迷子防止**
- このページは固定して、リンクは新規タブで開くなど工夫してください。

**目標**
- DifyでRAGを使ったチャットを作る
- ストレッチ目標: LINEとの連携

**心持ち**
- 仕組みを理解する、ではなく「体験する」
- 講師も練習だと思っているので、期待しすぎないゆるい気持ち
- 時間が短いので全てできない可能性があります。完璧を目指さない

**進め方**
- 現地とオンラインがいるので、現地勢の進捗に合わせる予定
- 6〜7割くらいの人がついて来れてそうなタイミングに合わせて講師作業を進めます
- 早く行ける人はガンガン進めちゃってください

---

## 1. Difyで簡単なチャットアプリを作る
まずはDifyでチャットを作っていきましょう。以下の資料を元に進めます。

- 記事内にあるプロンプトは、秋葉原ではなく  
  **「盛岡の観光アドバイザー」**というプロンプトにして試してみましょう。

---

## 2. モデルプロバイダーをGeminiへ
無料枠があるGeminiのAPIキーを設定しましょう。  
デフォルトだとGPT系ちょっとは使えるけど、すぐ制限来てしまう。

### 2-1. GeminiのAPI取得
- Google AI StudioからAPIキーを取得します。

### 2-2. Difyのモデルプロバイダー設定
- Difyは「モデルプロバイダー」という画面から各種AIモデルを追加できます。

**スクショ**
- CleanShot 2025-08-09 at 12.39.07.png

- OpenAIのAPIキーがある人はOpenAIを使うなど、他のAPIでもOKです。

**スクショ**
- CleanShot 2025-08-09 at 12.55.39.png

**手順**
- モデルプロバイダー > Gemini > セットアップ と進み、APIキーをセットします。

**スクショ**
- CleanShot 2025-08-09 at 12.57.02.png  
- CleanShot 2025-08-09 at 12.57.09.png（セット成功）

これで、ある程度使っても無料で制限も緩和されてAIが利用できます。

> 制限が来ないとは言い切れないので、その場合はGroqのAPIとモデルプロバイダーを利用するのがお勧めです。  
> 余裕ある人はGroqのAPIキーも発行しておくと後で遊べるかもです。

---

## 3. RAGアプリを作成
ナレッジ機能を使い、検索拡張機能を付与しましょう。

盛岡のナレッジや組織内のナレッジなどローカル情報には生成AIは弱く、学習してない情報に対してそれっぽい間違った回答を生成することがあります（**ハルシネーション**）。

これを回避するために、AIに情報と検索機能を持たせてあげて回答精度を上げる手法を**RAG**と呼びます。

### 3-0. RAGの解説
（ここに解説が入る想定）

### 3-1. 利用するナレッジをDL
- ↑こちらのテキストを `morioka.txt` か `morioka.md` などのファイル名で手元に保存しましょう。

**スクショ**
- CleanShot 2025-08-09 at 13.07.42.png

- 直接DLしたい人はこちらからzipでDLできます。  
（リンクをここに記載）

### 3-2. ナレッジデータを登録
- ナレッジのメニューに移動します。

**スクショ**
- CleanShot 2025-08-09 at 13.04.14.png

**手順**
1. 「ナレッジベースを作成」を選択  
   - CleanShot 2025-08-09 at 13.05.07.png
2. 先ほどのファイルをアップロードします  
   - CleanShot 2025-08-09 at 13.10.43.png

### 3-2. 埋め込み（親子分割モード）と検索設定

#### 埋め込み: チャンク設定
- 親子の方が基本的には精度高いです  
- 汎用の方が簡単だけど、僕が勉強したかったので親子分割モードにします

**スクショ**
- CleanShot 2025-08-09 at 13.11.33.png

**設定値**
```txt
チャンク識別子: ##
検索用子チャンク識別子: =====
